---
language: python
python:
  - "2.7"
env:
  - TEST=00-syntax
  - TEST=01-defaults
before_install:
 - sudo apt-get update -qq
 - sudo apt-get install -qq realpath
 - sudo apt-get install -qq python-apt python-pycurl
install:
  - pip install ansible
  - ansible --version
script:
  - echo  localhost > inventory
  - cd tests/$TEST && echo  "[defaults]"                      > tests/$TEST/ansible.cfg
  - cd tests/$TEST && echo  "roles_path = ../../../"          >> ansible.cfg
  - cd tests/$TEST && echo  "remote_user = root"              >> tests/$TEST/ansible.cfg
  - cd tests/$TEST && echo  "vars_files:"                     >> tests/$TEST/ansible.cfg
  - cd tests/$TEST && echo  "  - 'vars/main.yml'"             >> tests/$TEST/ansible.cfg
  - cd tests/$TEST && cat   ansible.cfg
  - cd tests/$TEST && echo  "---"                             > tests/$TEST/playbook.yml
  - cd tests/$TEST && echo  "- roles:"                        >> tests/$TEST/playbook.yml
  - cd tests/$TEST && echo  "    - $(basename $(realpath .))" >> tests/$TEST/playbook.yml
  - cd tests/$TEST && cat   playbook.yml
  - ansible-playbook -i inventory --syntax-check --list-tasks tests/$TEST/playbook.yml

#  - ansible-playbook -i inventory --connection=local --sudo -vvvv tests/01-defaults/playbook.yml
#  - ansible-playbook -i inventory --connection=local --sudo -vvvv tests/01-defaults/validate.yml